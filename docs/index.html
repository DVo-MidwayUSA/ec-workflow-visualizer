<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8">

  <title>EC Workflow Visualizer</title>
  <meta name="description" content="EC Workflow Visualizer">
  <meta name="author" content="dvo@midwayusacom">

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <link rel="stylesheet" href="https://dvo-midwayusa.github.io/ec-workflow-visualizer/css/styles.css" />
</head>

<body>
    <script src="https://www.gstatic.com/firebasejs/5.8.4/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyANpTOFJbUD8sWCbUtILlVCmkBtFb_tD3A",
        authDomain: "ec-workflow-visualizer.firebaseapp.com",
        databaseURL: "https://ec-workflow-visualizer.firebaseio.com",
        projectId: "ec-workflow-visualizer",
        storageBucket: "ec-workflow-visualizer.appspot.com",
        messagingSenderId: "200601179671"
      };
      firebase.initializeApp(config);
    </script>
  <div class="container-fluid">
    <h1>EC Workflow</h1>
    <div class="card col-3">
    <div class="card-body">
        Prioritization
        <div class="card">
            <div class="card-body">
                To be prioritized
                <span class="badge badge-secondary" id="toPrioritizeCount">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Prioritized
                <span class="badge badge-secondary" id="prioritizedCount">--</span>
            </div>
        </div>
    </div>
</div>
<script>
    var database = firebase.database();
    
    var el1 = document.getElementById('toPrioritizeCount');
    doStuff(el1, 'stats/toPrioritize');

    var el2 = document.getElementById('prioritizedCount');
    doStuff(el2, 'stats/prioritized');

    function doStuff(el, ref) {
        var toPrioritizeCt = database.ref(ref);
        toPrioritizeCt.on('value', function(snap) {
            
            el.classList.add('badge-primary');
            el.classList.remove('badge-secondary');
            
            el.textContent = snap.val();

            setTimeout(function () {
                el.classList.add('badge-secondary');
                el.classList.remove('badge-primary');
            }, 1000);
        });
    }
</script>    
  </div>
</body>

</html>