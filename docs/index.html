<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8">

  <title>EC Workflow Visualizer</title>
  <meta name="description" content="EC Workflow Visualizer">
  <meta name="author" content="dvo@midwayusacom">

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/styles.css" />
</head>

<body>
    <script src="https://www.gstatic.com/firebasejs/5.8.4/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyANpTOFJbUD8sWCbUtILlVCmkBtFb_tD3A",
        authDomain: "ec-workflow-visualizer.firebaseapp.com",
        databaseURL: "https://ec-workflow-visualizer.firebaseio.com",
        projectId: "ec-workflow-visualizer",
        storageBucket: "ec-workflow-visualizer.appspot.com",
        messagingSenderId: "200601179671"
      };
      firebase.initializeApp(config);
    </script>
  <div class="container-fluid">
    <h1><a href="/">EC Workflow</a></h1>
    
<h2>Feature System</h2>
<div class="divider">
    <i class="fas fa-play-circle start"></i>
</div>
<div class="card col-3 section-process">
    <div class="card-body">
        Prioritization
        <div class="card">
            <div class="card-body">
                To be prioritized
                <span class="badge badge-secondary" data-count="prioritization_toPrioritize">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Prioritized
                <span class="badge badge-secondary" data-count="prioritization_prioritized">--</span>
            </div>
        </div>
    </div>
</div>
<div class="divider">
    <i class="fas fa-angle-double-right"></i>
</div>
<div class="card col-3 section-process">
    <div class="card-body">
        Concept Creation
        <div class="card">
            <div class="card-body">
                To Be Reviewed
                <span class="badge badge-secondary" data-count="conceptCreation_toBeReviewed">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Reviewed
                <span class="badge badge-secondary" data-count="conceptCreation_reviewed">--</span>
            </div>
        </div>
    </div>
</div>
<div class="divider">
    <i class="fas fa-angle-double-right"></i>
</div>
<div class="card col-3 section-process">
    <div class="card-body">
        Concept Validation
        <div class="card">
            <div class="card-body">
                Queued Experiments
                <span class="badge badge-secondary" data-count="conceptValidation_queuedExperiments">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Active Experiments
                <span class="badge badge-secondary" data-count="conceptValidation_activeExperiements">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Slow-roll / Dark Launch
                <span class="badge badge-secondary" data-count="conceptValidation_slowRoll">--</span>
            </div>
        </div>
    </div>
</div>
<div class="divider">
    <i class="fas fa-angle-double-right"></i>
</div>
<div class="divider clear">
    <i class="fas fa-angle-double-right"></i>
</div>
<div class="card col-3 section-process">
    <div class="card-body">
        Build
        <div class="card">
            <div class="card-body">
                Backlog
                <span class="badge badge-secondary" data-count="build_backlog">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Work In Progress
                <span class="badge badge-secondary" data-count="build_workInProgress">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Blocks
                <span class="badge badge-secondary" data-count="build_blocks">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Rejected Stories
                <span class="badge badge-secondary" data-count="build_rejectedStories">--</span>
            </div>
        </div>
    </div>
</div>
<div class="divider">
    <i class="fas fa-angle-double-right"></i>
</div>
<div class="card col-3 section-process">
    <div class="card-body">
        Ready to Release
        <div class="card">
            <div class="card-body">
                Smoke Testing
                <span class="badge badge-secondary" data-count="readyRelease_smokeTesting">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Performance Testing
                <span class="badge badge-secondary" data-count="readyRelease_performanceTesting">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Load Testing
                <span class="badge badge-secondary" data-count="readyRelease_loadTesting">--</span>
            </div>
        </div>
    </div>
</div>
<div class="divider">
    <i class="fas fa-angle-double-right"></i>
</div>
<div class="card col-3 section-process">
    <div class="card-body">
        Deployment
        <div class="card">
            <div class="card-body">
                Persisted
                <span class="badge badge-secondary" data-count="deployment_persisted">--</span>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                Rollbacks
                <span class="badge badge-secondary" data-count="deployment_rollbacks">--</span>
            </div>
        </div>
    </div>
</div>
<div class="divider">
    <i class="fas fa-ban stop"></i>
</div>

<script>
    const database = firebase.database()

    const el = document.querySelectorAll('[data-count]')
    el.forEach(e => count(e))

    function count(el) {
        const stats = database.ref(`stats/${el.dataset.count}`)
            .on('value', (snapshot) => {
                updateValue(el, snapshot)
                transition(el)
            })
    }

    function updateValue(el, snapshot) {
        el.textContent = snapshot.val().Count
    }

    function transition(el) {
        el.classList.add('badge-primary')
        el.classList.remove('badge-secondary')
        setTimeout(() => {
            el.classList.add('badge-secondary')
            el.classList.remove('badge-primary')
        }, 1000)
    }
</script>
  </div>
</body>

</html>